<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary SEO Meta Tags -->
    <title>Financial Analytics & Revenue Dashboard | TotalCareIT Partner Portal</title>
    <meta name="description" content="Comprehensive financial dashboard for MSP and DaaS revenue tracking. Monitor MRR, ARR, profit margins, client distribution, and expense management. Real-time business intelligence for managed services nationwide.">
    <meta name="keywords" content="MSP financial dashboard, MRR tracking, ARR analytics, DaaS revenue management, profit margin analysis, MSP business intelligence, revenue forecasting, expense tracking, financial KPIs, managed services finance, client profitability">
    <link rel="canonical" href="https://totalcareit.ai/finance.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://totalcareit.ai/finance.html">
    <meta property="og:title" content="Financial Analytics & Revenue Dashboard | TotalCareIT Partner Portal">
    <meta property="og:description" content="Real-time MSP and DaaS financial analytics with MRR, ARR tracking, profit margin analysis, and comprehensive expense management.">
    <meta property="og:image" content="https://totalcareit.com/wp-content/uploads/2024/11/TotalCareIT-Registered-Logo-Full-Color.webp">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://totalcareit.ai/finance.html">
    <meta name="twitter:title" content="Financial Analytics & Revenue Dashboard | TotalCareIT Partner Portal">
    <meta name="twitter:description" content="Real-time MSP and DaaS financial analytics with MRR, ARR tracking, profit margin analysis, and comprehensive expense management.">
    <meta name="twitter:image" content="https://totalcareit.com/wp-content/uploads/2024/11/TotalCareIT-Registered-Logo-Full-Color.webp">

    <!-- Structured Data for AI Search Engines -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "TotalCareIT Finance Dashboard",
      "description": "Financial analytics and revenue dashboard for MSP and DaaS business management with MRR, ARR, and profit tracking",
      "url": "https://totalcareit.ai/finance.html",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "provider": {
        "@type": "Organization",
        "name": "TotalCareIT",
        "url": "https://totalcareit.ai"
      },
      "featureList": [
        "Monthly Recurring Revenue (MRR) tracking",
        "Annual Recurring Revenue (ARR) analytics",
        "MSP revenue management",
        "DaaS revenue tracking",
        "Profit margin analysis",
        "Client distribution analytics",
        "Service tier revenue breakdown",
        "Expense management",
        "AWS billing integration",
        "Revenue trend forecasting",
        "Financial KPI monitoring",
        "Client profitability analysis"
      ]
    }
    </script>

    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://alcdn.msauth.net/browser/2.30.0/js/msal-browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <style>
        .finance-header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .finance-header h1 {
            margin: 0 0 0.5rem 0;
            font-size: 2rem;
            font-weight: 700;
        }

        .finance-header p {
            margin: 0;
            opacity: 0.95;
        }

        .tab-navigation {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: white;
            padding: 0.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .tab-button {
            flex: 1;
            padding: 1rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #6b7280;
        }

        .tab-button:hover {
            background: #f3f4f6;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid;
        }

        .metric-card.revenue {
            border-left-color: #10b981;
        }

        .metric-card.mrr {
            border-left-color: #3b82f6;
        }

        .metric-card.arr {
            border-left-color: #8b5cf6;
        }

        .metric-card.growth {
            border-left-color: #f59e0b;
        }

        .metric-card h3 {
            margin: 0 0 0.5rem 0;
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
        }

        .metric-card .value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1f2937;
            margin: 0.5rem 0;
        }

        .metric-card .change {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .metric-card .change.positive {
            color: #10b981;
        }

        .metric-card .change.negative {
            color: #ef4444;
        }

        .chart-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
        }

        .chart-section h2 {
            margin: 0 0 1.5rem 0;
            color: #1f2937;
        }

        .revenue-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .breakdown-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .breakdown-card h3 {
            margin: 0 0 1rem 0;
            color: #1f2937;
            font-size: 1.125rem;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .breakdown-item:last-child {
            border-bottom: none;
        }

        .breakdown-label {
            color: #6b7280;
            font-weight: 500;
        }

        .breakdown-value {
            font-weight: 700;
            color: #1f2937;
        }

        .client-list {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .client-list table {
            width: 100%;
            border-collapse: collapse;
        }

        .client-list th {
            background: #f9fafb;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #374151;
            font-size: 0.875rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .client-list td {
            padding: 1rem;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.875rem;
        }

        .client-list tbody tr:hover {
            background: #f9fafb;
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-badge.trial {
            background: #fef3c7;
            color: #92400e;
        }

        .status-badge.pending {
            background: #dbeafe;
            color: #1e40af;
        }

        .aws-billing-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .billing-header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .billing-amount-large {
            font-size: 3rem;
            font-weight: 700;
            color: #1f2937;
        }

        .billing-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .billing-detail-item {
            padding: 1rem;
            background: #f9fafb;
            border-radius: 8px;
        }

        .billing-detail-label {
            font-size: 0.75rem;
            color: #6b7280;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 0.25rem;
        }

        .billing-detail-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1f2937;
        }

        .service-breakdown {
            margin-top: 1.5rem;
        }

        .service-breakdown h4 {
            margin: 0 0 1rem 0;
            color: #374151;
            font-size: 1rem;
        }

        .service-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            border-bottom: 1px solid #f3f4f6;
        }

        .service-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body class="dashboard-page">
    <div class="dashboard-container">
        <!-- Partner Portal Navigation (loaded from includes/partner-nav.html) -->
        <div id="partner-nav-placeholder"></div>
        <script src="js/load-nav.js"></script>

        <main class="dashboard-main">
            <div class="finance-header">
                <h1>ðŸ’° Finance Dashboard</h1>
                <p>Comprehensive financial tracking for MSP, DaaS, and operational expenses</p>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-button active" onclick="switchTab('overview')">ðŸ“Š Overview</button>
                <button class="tab-button" onclick="switchTab('msp')">ðŸ”§ MSP Revenue</button>
                <button class="tab-button" onclick="switchTab('daas')">ðŸ’» DaaS Revenue</button>
                <button class="tab-button" onclick="switchTab('expenses')">ðŸ“‰ Expenses</button>
            </div>

            <!-- Overview Tab -->
            <div id="overview-tab" class="tab-content active">
                <!-- Key Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card revenue">
                        <h3>Total Monthly Revenue</h3>
                        <div class="value" id="total-revenue">$0</div>
                        <div class="change positive" id="revenue-change">â†‘ 12.5% vs last month</div>
                    </div>
                    <div class="metric-card mrr">
                        <h3>Monthly Recurring Revenue</h3>
                        <div class="value" id="total-mrr">$0</div>
                        <div class="change positive" id="mrr-change">â†‘ 8.3% growth</div>
                    </div>
                    <div class="metric-card arr">
                        <h3>Annual Recurring Revenue</h3>
                        <div class="value" id="total-arr">$0</div>
                        <div class="change positive">Projected ARR</div>
                    </div>
                    <div class="metric-card growth">
                        <h3>Net Profit Margin</h3>
                        <div class="value" id="profit-margin">0%</div>
                        <div class="change positive" id="margin-change">â†‘ 3.2 points</div>
                    </div>
                </div>

                <!-- Revenue Breakdown -->
                <div class="revenue-breakdown">
                    <div class="breakdown-card">
                        <h3>Revenue by Service Type</h3>
                        <div class="breakdown-item">
                            <span class="breakdown-label">MSP Services</span>
                            <span class="breakdown-value" id="overview-msp-revenue">$0</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">DaaS Subscriptions</span>
                            <span class="breakdown-value" id="overview-daas-revenue">$0</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Project Work</span>
                            <span class="breakdown-value">$12,500</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Support Contracts</span>
                            <span class="breakdown-value">$8,400</span>
                        </div>
                    </div>

                    <div class="breakdown-card">
                        <h3>Client Distribution</h3>
                        <div class="breakdown-item">
                            <span class="breakdown-label">IT Essentials</span>
                            <span class="breakdown-value">18 clients</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">IT Assist</span>
                            <span class="breakdown-value">12 clients</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">IT360</span>
                            <span class="breakdown-value">5 clients</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">DaaS Only</span>
                            <span class="breakdown-value">8 clients</span>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="chart-section">
                    <h2>Revenue Trend (Last 12 Months)</h2>
                    <canvas id="revenueChart" height="80"></canvas>
                </div>
            </div>

            <!-- MSP Revenue Tab -->
            <div id="msp-tab" class="tab-content">
                <div class="metrics-grid">
                    <div class="metric-card revenue">
                        <h3>MSP Monthly Revenue</h3>
                        <div class="value" id="msp-monthly">$0</div>
                        <div class="change positive">From managed services</div>
                    </div>
                    <div class="metric-card mrr">
                        <h3>Active Contracts</h3>
                        <div class="value" id="msp-contracts">35</div>
                        <div class="change positive">â†‘ 3 new this month</div>
                    </div>
                    <div class="metric-card arr">
                        <h3>Average Contract Value</h3>
                        <div class="value" id="msp-acv">$0</div>
                        <div class="change positive">Per client/month</div>
                    </div>
                    <div class="metric-card growth">
                        <h3>Managed Endpoints</h3>
                        <div class="value" id="msp-endpoints">892</div>
                        <div class="change positive">Total devices</div>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>MSP Revenue by Service Tier</h2>
                    <canvas id="mspTierChart" height="80"></canvas>
                </div>

                <div class="client-list">
                    <table>
                        <thead>
                            <tr>
                                <th>Client Name</th>
                                <th>Service Tier</th>
                                <th>Users</th>
                                <th>Servers</th>
                                <th>Monthly Value</th>
                                <th>Status</th>
                                <th>Contract End</th>
                            </tr>
                        </thead>
                        <tbody id="msp-clients">
                            <!-- Populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- DaaS Revenue Tab -->
            <div id="daas-tab" class="tab-content">
                <div class="metrics-grid">
                    <div class="metric-card revenue">
                        <h3>DaaS Monthly Revenue</h3>
                        <div class="value" id="daas-monthly">$0</div>
                        <div class="change positive">Device subscriptions</div>
                    </div>
                    <div class="metric-card mrr">
                        <h3>Active Devices</h3>
                        <div class="value" id="daas-devices">324</div>
                        <div class="change positive">â†‘ 28 added this month</div>
                    </div>
                    <div class="metric-card arr">
                        <h3>Average Per Device</h3>
                        <div class="value" id="daas-per-device">$0</div>
                        <div class="change positive">Monthly average</div>
                    </div>
                    <div class="metric-card growth">
                        <h3>DaaS Clients</h3>
                        <div class="value" id="daas-clients">23</div>
                        <div class="change positive">Total subscribers</div>
                    </div>
                </div>

                <div class="revenue-breakdown">
                    <div class="breakdown-card">
                        <h3>Device Type Distribution</h3>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Business Laptops</span>
                            <span class="breakdown-value">186 devices</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Premium Laptops</span>
                            <span class="breakdown-value">94 devices</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Desktops</span>
                            <span class="breakdown-value">32 devices</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Tablets</span>
                            <span class="breakdown-value">12 devices</span>
                        </div>
                    </div>

                    <div class="breakdown-card">
                        <h3>DaaS Revenue Breakdown</h3>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Device Subscriptions</span>
                            <span class="breakdown-value" id="daas-device-rev">$0</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Management Fees</span>
                            <span class="breakdown-value">$8,100</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Support Services</span>
                            <span class="breakdown-value">$3,240</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Refresh Credits</span>
                            <span class="breakdown-value" style="color: #ef4444;">-$2,100</span>
                        </div>
                    </div>
                </div>

                <div class="chart-section">
                    <h2>DaaS Growth Trend</h2>
                    <canvas id="daasGrowthChart" height="80"></canvas>
                </div>
            </div>

            <!-- Expenses Tab -->
            <div id="expenses-tab" class="tab-content">
                <div class="metrics-grid">
                    <div class="metric-card revenue">
                        <h3>Total Monthly Expenses</h3>
                        <div class="value">$24,580</div>
                        <div class="change negative">â†‘ 5.2% vs last month</div>
                    </div>
                    <div class="metric-card mrr">
                        <h3>Operating Expenses</h3>
                        <div class="value">$18,240</div>
                        <div class="change positive">Operational costs</div>
                    </div>
                    <div class="metric-card arr">
                        <h3>Cost of Goods Sold</h3>
                        <div class="value">$6,340</div>
                        <div class="change positive">Hardware & licenses</div>
                    </div>
                    <div class="metric-card growth">
                        <h3>Profit Margin</h3>
                        <div class="value">68.2%</div>
                        <div class="change positive">After all expenses</div>
                    </div>
                </div>

                <!-- AWS Billing -->
                <div class="aws-billing-card">
                    <div class="billing-header-row">
                        <div>
                            <h2 style="margin: 0 0 0.5rem 0;">AWS Infrastructure Costs</h2>
                            <p style="margin: 0; color: #6b7280;">October 2025 - Updated in Real-Time</p>
                        </div>
                        <span style="background: #dbeafe; color: #1e40af; padding: 0.5rem 1rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 600;">LIVE</span>
                    </div>

                    <div class="billing-amount-large">
                        $5.80
                    </div>

                    <div class="billing-details-grid">
                        <div class="billing-detail-item">
                            <div class="billing-detail-label">Days Elapsed</div>
                            <div class="billing-detail-value">27 / 31</div>
                        </div>
                        <div class="billing-detail-item">
                            <div class="billing-detail-label">Daily Average</div>
                            <div class="billing-detail-value">$0.21</div>
                        </div>
                        <div class="billing-detail-item">
                            <div class="billing-detail-label">Projected Total</div>
                            <div class="billing-detail-value">$6.67</div>
                        </div>
                        <div class="billing-detail-item">
                            <div class="billing-detail-label">Budget Status</div>
                            <div class="billing-detail-value" style="color: #10b981;">Under</div>
                        </div>
                    </div>

                    <div class="service-breakdown">
                        <h4>Service Breakdown</h4>
                        <div class="service-item">
                            <span>EC2 (Elastic Compute Cloud)</span>
                            <span style="font-weight: 700;">$4.29</span>
                        </div>
                        <div class="service-item">
                            <span>VPC (Virtual Private Cloud)</span>
                            <span style="font-weight: 700;">$0.90</span>
                        </div>
                        <div class="service-item">
                            <span>Route 53 (DNS)</span>
                            <span style="font-weight: 700;">$0.50</span>
                        </div>
                        <div class="service-item">
                            <span>Secrets Manager</span>
                            <span style="font-weight: 700;">$0.10</span>
                        </div>
                        <div class="service-item">
                            <span>S3 (Simple Storage)</span>
                            <span style="font-weight: 700;">$0.01</span>
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem; padding: 1rem; background: #fef3c7; border-radius: 8px; font-size: 0.875rem; color: #92400e;">
                        <strong>Note:</strong> This AWS account was created in October 2025. Historical billing data will appear as additional months become available.
                    </div>
                </div>

                <div class="chart-section" style="margin-top: 2rem;">
                    <h2>Expense Categories</h2>
                    <canvas id="expensesChart" height="80"></canvas>
                </div>
            </div>
        </main>
    </div>

    <script src="js/auth.js"></script>
    <script>
        // Sample data
        const financialData = {
            msp: {
                monthlyRevenue: 85400,
                contracts: 35,
                endpoints: 892,
                clients: [
                    { name: 'Acme Corp', tier: 'IT360', users: 85, servers: 4, monthly: 18250, status: 'active', contractEnd: '2026-03-15' },
                    { name: 'TechStart Inc', tier: 'IT Assist', users: 42, servers: 2, monthly: 6430, status: 'active', contractEnd: '2025-12-31' },
                    { name: 'Global Solutions', tier: 'IT360', users: 125, servers: 8, monthly: 28650, status: 'active', contractEnd: '2026-06-30' },
                    { name: 'SmartBiz LLC', tier: 'IT Essentials', users: 18, servers: 1, monthly: 1950, status: 'active', contractEnd: '2025-11-15' },
                    { name: 'Innovate Co', tier: 'IT Assist', users: 65, servers: 3, monthly: 10350, status: 'active', contractEnd: '2026-01-31' }
                ]
            },
            daas: {
                monthlyRevenue: 28440,
                devices: 324,
                clients: 23
            }
        };

        function switchTab(tab) {
            // Update buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Update content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');
        }

        function formatCurrency(value) {
            return '$' + value.toLocaleString();
        }

        function loadFinancialData() {
            // Calculate totals
            const totalRevenue = financialData.msp.monthlyRevenue + financialData.daas.monthlyRevenue;
            const totalMRR = totalRevenue;
            const totalARR = totalRevenue * 12;
            const avgContractValue = financialData.msp.monthlyRevenue / financialData.msp.contracts;
            const avgPerDevice = financialData.daas.monthlyRevenue / financialData.daas.devices;

            // Update overview metrics
            document.getElementById('total-revenue').textContent = formatCurrency(totalRevenue);
            document.getElementById('total-mrr').textContent = formatCurrency(totalMRR);
            document.getElementById('total-arr').textContent = formatCurrency(totalARR);
            document.getElementById('profit-margin').textContent = '68.2%';

            document.getElementById('overview-msp-revenue').textContent = formatCurrency(financialData.msp.monthlyRevenue);
            document.getElementById('overview-daas-revenue').textContent = formatCurrency(financialData.daas.monthlyRevenue);

            // Update MSP metrics
            document.getElementById('msp-monthly').textContent = formatCurrency(financialData.msp.monthlyRevenue);
            document.getElementById('msp-contracts').textContent = financialData.msp.contracts;
            document.getElementById('msp-acv').textContent = formatCurrency(Math.round(avgContractValue));
            document.getElementById('msp-endpoints').textContent = financialData.msp.endpoints;

            // Update DaaS metrics
            document.getElementById('daas-monthly').textContent = formatCurrency(financialData.daas.monthlyRevenue);
            document.getElementById('daas-devices').textContent = financialData.daas.devices;
            document.getElementById('daas-per-device').textContent = formatCurrency(Math.round(avgPerDevice));
            document.getElementById('daas-clients').textContent = financialData.daas.clients;
            document.getElementById('daas-device-rev').textContent = formatCurrency(financialData.daas.monthlyRevenue - 8100 - 3240 + 2100);

            // Load MSP clients table
            const tbody = document.getElementById('msp-clients');
            tbody.innerHTML = financialData.msp.clients.map(client => `
                <tr>
                    <td><strong>${client.name}</strong></td>
                    <td>${client.tier}</td>
                    <td>${client.users}</td>
                    <td>${client.servers}</td>
                    <td><strong>${formatCurrency(client.monthly)}</strong></td>
                    <td><span class="status-badge ${client.status}">${client.status}</span></td>
                    <td>${new Date(client.contractEnd).toLocaleDateString()}</td>
                </tr>
            `).join('');
        }

        function createCharts() {
            // Revenue Trend Chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: ['Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                    datasets: [{
                        label: 'Total Revenue',
                        data: [95000, 98000, 102000, 105000, 108000, 107000, 110000, 111000, 112000, 113000, 112000, 113840],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: false } }
                }
            });

            // MSP Tier Chart
            const mspTierCtx = document.getElementById('mspTierChart').getContext('2d');
            new Chart(mspTierCtx, {
                type: 'bar',
                data: {
                    labels: ['IT Essentials', 'IT Assist', 'IT360'],
                    datasets: [{
                        label: 'Monthly Revenue',
                        data: [24300, 28400, 32700],
                        backgroundColor: ['#3b82f6', '#8b5cf6', '#10b981']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true
                }
            });

            // DaaS Growth Chart
            const daasGrowthCtx = document.getElementById('daasGrowthChart').getContext('2d');
            new Chart(daasGrowthCtx, {
                type: 'line',
                data: {
                    labels: ['Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                    datasets: [{
                        label: 'Active Devices',
                        data: [180, 195, 210, 225, 238, 252, 265, 278, 289, 298, 310, 324],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: false } }
                }
            });

            // Expenses Chart
            const expensesCtx = document.getElementById('expensesChart').getContext('2d');
            new Chart(expensesCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Salaries', 'Software & Licenses', 'Hardware', 'Office & Overhead', 'Marketing', 'AWS/Cloud'],
                    datasets: [{
                        data: [12000, 4200, 3500, 2800, 1500, 580],
                        backgroundColor: ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444', '#06b6d4']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true
                }
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadFinancialData();
            createCharts();
        });
    </script>
</body>
</html>
